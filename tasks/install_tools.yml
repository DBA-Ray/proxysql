- name: Install the percona-release repository
  yum:
    name: https://repo.percona.com/yum/percona-release-latest.noarch.rpm
    state: present
  register: percona_release
  retries: 3
  until: percona_release is succeeded

- name: Unstall pmm-client.x86_64
  yum:
    name: pmm-client.x86_64
    state: absent

- name: Install the percona tools for pmm2-client
  yum:
    name: "{{ tools }}"
  vars:
    tools:
    - pmm2-client.x86_64
    state: latest
  register: result
  retries: 7
  until: result is succeeded